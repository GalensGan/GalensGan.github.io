---
layout: post
title: 02-Git基础
category: Git技巧
tagline: by 明不知昔
tags: 
  - Git
published: true
---

02-Git基础篇精简笔记。

<!--more-->

## 获取 Git 仓库

通常有两种获取 Git 项目仓库的方式：

### 在已存在目录中初始化仓库

``` 
git init
```

### 克隆现有的仓库

``` 
// 第一种方式
git clone <url> 

// 第二种方式,可以将目标目录进行重命名
git clone <url> targetDirectoryName
```

## 记录每次更新到仓库

工作目录下的每一个文件都只有这两种状态：**已跟踪** 或 **未跟踪**。 已跟踪的文件是指那些被纳入了版本控制的文件，在上一次快照中有它们的记录，在工作一段时间后， 它们的状态可能是未修改，已修改或已放入暂存区。

### 检查当前文件状态

可以用 `git status` 命令查看哪些文件处于什么状态。

### 跟踪新文件

使用命令 `git add <files>` 开始跟踪一个文件。

- 多个文件用空格隔开

- 如果参数是目录的路径，该命令将递归地跟踪该目录下的所有文件
- 使用 `-A` 或 `--all` 或 `.` 参数添加所有的文件

### 暂存（stage）已修改的文件

使用命令 `git add <files>` 将文件放入暂存区中。

`git add` 可以用它开始跟踪新文件，或者把已跟踪的文件放到暂存区，还能用于合并时把有冲突的文件标记为已解决状态等。 可以将这个命令理解为“将内容添加到下一次提交中”。

### 状态简览

使用 `git status -s` 命令或 `git status --short` 命令，你将得到一种格式更为紧凑的输出。

- ??：新添加的未跟踪文件
- A：新添加到暂存区中的文件
- M：修改过的文件

输出中有两栏，左栏指明了暂存区的状态，右栏指明了工作区的状态。

``` javascript
$ git status -s
 M README //README 文件在工作区已修改但尚未暂存
MM Rakefile //文件已修改，暂存后又作了修改，因此该文件的修改中既有已暂存的部分，又有未暂存的部分
A  lib/git.rb 
M  lib/simplegit.rb //文件已修改且已暂存
?? LICENSE.txt
```

### 忽略文件

可以创建一个名为 `.gitignore` 的文件，列出要忽略的文件的模式。

文件 `.gitignore` 的格式规范如下：

- 所有空行或者以 `#` 开头的行都会被 Git 忽略。
- 可以使用标准的 glob 模式匹配，它会递归地应用在整个工作区中。
- 匹配模式可以以（`/`）开头防止递归。
- 匹配模式可以以（`/`）结尾指定目录。
- 要忽略指定模式以外的文件或目录，可以在模式前加上叹号（`!`）取反。

所谓的 glob 模式是指 shell 所使用的简化了的正则表达式。

-  星号（`*`）匹配零个或多个任意字符

- `[abc]` 匹配任何一个列在方括号中的字符 （这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）； 
- 问号（`?`）只匹配一个任意字符
- 如果在方括号中使用短划线分隔两个字符， 表示所有在这两个字符范围内的都可以匹配（比如 `[0-9]` 表示匹配所有 0 到 9 的数字）
-  使用两个星号（`**`）表示匹配任意中间目录，比如 `a/**/z` 可以匹配 `a/z` 、 `a/b/z` 或 `a/b/c/z` 

``` dos
# 忽略所有的 .a 文件
*.a

# 但跟踪所有的 lib.a，即便你在前面忽略了 .a 文件
!lib.a

# 只忽略当前目录下的 TODO 文件，而不忽略 subdir/TODO
/TODO

# 忽略任何目录下名为 build 的文件夹
build/

# 忽略 doc/notes.txt，但不忽略 doc/server/arch.txt
doc/*.txt

# 忽略 doc/ 目录及其所有子目录下的 .pdf 文件
doc/**/*.pdf
```

> GitHub 有一个十分详细的针对数十种项目及语言的 `.gitignore` 文件列表， 可以在 https://github.com/github/gitignore 找到它。
>
> 一个仓库可能只根目录下有一个 `.gitignore` 文件，它递归地应用到整个仓库中。 然而，子目录下也可以有额外的 `.gitignore` 文件。子目录中的 `.gitignore` 文件中的规则只作用于它所在的目录中。

### 查看已暂存和未暂存的修改

想知道具体修改了什么地方，可以用 `git diff` 命令。

- `git diff` 本身只显示尚未暂存的改动，而不是自上次提交以来所做的所有改动。
- `git diff --staged` 或者 `git diff --cached`查看已暂存的将要添加到下次提交里的内容。

### 提交更新

`git commit` 或者 `git commit -m <message>`

### 跳过添加到暂存区域步骤

Git 提供了一个跳过添加到暂存区域这一步骤的方式， 只要在提交的时候，给 `git commit` 加上 `-a` 选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 `git add` 步骤。

> 但是要小心，有时这个选项会将不需要的文件添加到提交中。

### 移除文件

- `git rm  <file>`：从已跟踪文件清单中移除，并且从工作目录中删除
- `git rm <file> -f`：删除之前修改过或已经放到暂存区的文件
- `git rm --cached <file>` 从 Git 仓库中删除（亦即从暂存区域移除），但仍保留在当前工作目录中

`git rm` 命令后面可以列出文件或者目录的名字，也可以使用 `glob` 模式。在命令行中，通配符前要加`\`转义。

### 移动文件

`git mv file_from file_to` 来进行重命名。一般来说，Git 会推断出重命名。

运行 `git mv` 就相当于运行了下面三条命令：

``` dos
$ mv README.md README
$ git rm README.md
$ git add README
```

## 查看提交历史

### 查看提交历史

使用 `git log` 命令

- `git log -p/--patch` ：示每次提交所引入的差异
- `-2`：只显示最近的两次提交
- `git log --stat`：每次提交的简略统计信息

> 更加详细说明，请查看官方文档：https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%9F%A5%E7%9C%8B%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2

## 撤消操作

- `git commit --amend`

有时候我们提交完了才发现漏掉了几个文件没有添加，或者提交信息写错了

## 其它

### git commit -m 换行

先输入第一个引号，按`Enter`即可换行，完成后再补齐后面的引号。



## 原文

https://git-scm.com/book/zh/v2

